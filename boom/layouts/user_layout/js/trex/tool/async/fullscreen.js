(function(){var f=document,e=window,c=f.documentElement,a=false,b=true,d=null,g;Trex.Class.overwrite(Trex.Tool.FullScreen,{oninitialized:function(){var l=this.editor,k=this.config;var j=l.getWrapper();if(!j){return}var h;var i=function(){if(!h){h=new Trex.FullScreen(l,k)}h.execute()};if(k.switched){if(!h){h=new Trex.FullScreen(l,k)}h.showFullScreen()}this.resetWeave();this.weave.bind(this)(new Trex.Button(this.buttonCfg),d,i);this.bindKeyboard({ctrlKey:b,keyCode:77},i);l.observeKey({ctrlKey:b,altKey:a,shiftKey:a,keyCode:77},i);i()}});TrexMessage.addMsg({"@fullscreen.attach.close.btn":"\ud30c\uc77c\ucca8\ubd80\ubc15\uc2a4","@fullscreen.noti.btn":"\uc77c\ubc18 \uae00\uc4f0\uae30\ub85c","@fullscreen.noti.span":"\ub113\uac8c\uc4f0\uae30 \ubc84\ud2bc\uc744 \ub2e4\uc2dc \ub204\ub974\uc2dc\uba74 \ucc98\uc74c \uae00\uc4f0\uae30 \ucc3d \ud06c\uae30\ub85c \ub3cc\uc544\uac11\ub2c8\ub2e4."});Trex.MarkupTemplate.add("fullscreen.notice",'<div class="tx-fullscreen-notice"><span>@fullscreen.noti.span</span><a href="#">@fullscreen.noti.btn</a></div>');
Trex.MarkupTemplate.add("fullscreen.linebox",'<div class="tx-fullscreen-line">			<div class="tx-fullscreen-line-division">				<div class="tx-fullscreen-line-left">&nbsp;</div>				<div class="tx-fullscreen-line-right">&nbsp;</div>			</div>			<div class="tx-fullscreen-line-box">				<div class="tx-fullscreen-line-left">&nbsp;</div>				<div class="tx-fullscreen-line-right">&nbsp;</div>				<a href="#">@fullscreen.attach.close.btn</a>			</div>		</div>');Trex.FullScreen=Trex.Class.create({initialize:function(i,h){if(!i){return}this.isInit=a;this.isFullScreen=a;this.wrapper=i.getWrapper();this.canvas=i.getCanvas();this.toolbar=i.getToolbar();this.attachBox=i.getAttachBox();this.elSavedHiddens=[];this.minHeight=h.minHeight;this.minWidth=h.minWidth;this.useAttachBox=(this.attachBox.elBox!==g);this.isAttachBoxDisplay=a;this.resizeHandler=this.resizeContainer.bind(this);this.toolbar.observeJob("toolbar.advanced.fold",function(){if(this.isFullScreen){this.resizeContainer()}}.bind(this));this.toolbar.observeJob("toolbar.advanced.spread",function(){if(this.isFullScreen){this.resizeContainer()
}}.bind(this));if(typeof(showAttachBox)!=g+""){this.showAttachBoxAtServiceForSave=showAttachBox}if(typeof(hideAttachBox)!=g+""){this.hideAttachBoxAtServiceForSave=hideAttachBox}},execute:function(){if(this.isFullScreen){this.showNormalScreen()}else{this.showFullScreen()}},onAttachClick:function(){this.attachClickHandler(!this.isAttachBoxDisplay);this.resizeContainer()},attachClickHandler:function(h){if(h){this.showAttachBox()}else{this.hideAttachBox()}},showNormalScreen:function(){if(!this.isFullScreen){return}this._showScrollbar();this.showNormalScreenAtService();var m=this.wrapper;if(!m){return}m.style.width="";$tx.removeClassName(m,"tx-editor-fullscreen");this.elSavedHiddens.each(function(i){i.style.visibility="visible"});if(parent){try{$tx.stopObserving(parent,"resize",this.resizeHandler)}catch(n){}}else{$tx.stopObserving(window,"resize",this.resizeHandler)}this.canvas.setCanvasSize({height:this.panelNormalHeight.toPx()});if(this.useAttachBox){this.attachClickHandler(this.attachBox.checkDisplay())
}this.canvas.fireJobs("canvas.normalscreen.change");if(this.showAttachBoxAtServiceForSave){e.showAttachBox=this.showAttachBoxAtServiceForSave}if(this.hideAttachBoxAtServiceForSave){e.hideAttachBox=this.hideAttachBoxAtServiceForSave}var k=this.relativeParents.length;for(var j=0;j<k;j++){var h=this.relativeParents.pop();var l=this.relativeValues.pop();$tx.setStyle(h,{position:l})}this.isFullScreen=a;if(!$tx.msie){setTimeout(function(){var i=$tom.collect($tx("tx_fullscreen"),"a");i.focus()}.bind(this),500)}},showFullScreen:function(){if(this.isFullScreen){return}if(!this.isInit){this.generate()}this._hideScrollbar();this.showFullScreenAtService();if(this.showAttachBoxAtServiceForSave){e.showAttachBox=function(){this.showAttachBox();this.resizeContainer()}.bind(this)}if(this.hideAttachBoxAtServiceForSave){e.hideAttachBox=function(){this.hideAttachBox();this.resizeContainer()}.bind(this)}var k=this.wrapper;if(!k){return}$tx.addClassName(k,"tx-editor-fullscreen");var l=[];["select","embed","object"].each(function(m){var n=$A(f.getElementsByTagName(m));
n.each(function(o){o.style.visibility="hidden";l.push(o)})});this.elSavedHiddens=l;if(this.useAttachBox){this.attachClickHandler(this.attachBox.checkDisplay())}var j=this.canvas.getCurrentPanel();this.panelNormalHeight=j.getPosition().height;if(i){$tx.observe(i,"resize",this.resizeHandler)}else{$tx.observe(window,"resize",this.resizeHandler)}this.canvas.fireJobs("canvas.fullscreen.change");e.wrapper=k;this.relativeParents=[];this.relativeValues=[];var i=k.offsetParent;while(i&&i.tagName&&i.tagName.toUpperCase()!="HTML"&&i.tagName.toUpperCase()!="BODY"){var h=$tx.getStyle(i,"position");if(h.toLowerCase()=="relative"){this.relativeParents.push(i);this.relativeValues.push(h);$tx.setStyle(i,{position:"static"})}i=i.offsetParent}this.isFullScreen=b;this.resizeContainer()},_hideScrollbar:function(){if(c.scrollTop||c.scrollLeft){c.scrollTop=0;c.scrollLeft=0}if(f.body.scrollTop||f.body.scrollLeft){f.body.scrollTop=0;f.body.scrollLeft=0}c.style.overflow="hidden";f.body.style.overflow="hidden"},_showScrollbar:function(){c.style.overflow="";
f.body.style.overflow=""},generate:function(){if(this.isInit){return}var l=this.wrapper;if(!l){return}var i=Trex.MarkupTemplate.get("fullscreen.notice").evaluateAsDom({});$tom.insertFirst(l,i);var o=$tom.collect(i,"a");$tx.observe(o,"click",function(){if(this.isFullScreen){this.showNormalScreen()}else{this.showFullScreen()}}.bind(this));var j=this.canvas.elContainer;var h=Trex.MarkupTemplate.get("fullscreen.linebox").evaluateAsDom({});$tom.insertNext(h,j);var n={className:"tx-fullscreen-line-box"};if($tx.msie_ver=="5.5"){n.align="center"}var m=$tom.collect(h,"div.tx-fullscreen-line-box");if($tx.msie_ver=="5.5"){m.align="center"}var k=this.elLineBtn=$tom.collect(m,"a");$tx.observe(k,"click",this.onAttachClick.bind(this));this.isInit=b},getAttachBoxPosition:function(){if(this.isAttachBoxDisplay){return $tom.getPosition(this.attachBox.elBox)}else{return{x:0,y:0,width:0,height:0}}},resizeContainer:function(){var n=function(){if($tx("tx_fullscreen_post_area")){return $tx.getDimensions($tx("tx_fullscreen_post_area"))
}else{return{x:0,y:0,width:0,height:0}}};if(!this.isFullScreen){return a}this.resizeScreenAtService();var j=this.canvas.getCanvasPos().y;var k=this.getAttachBoxPosition();var h=0;var i=n();if(c.clientHeight>0){h=c.clientHeight-j-17}else{h=c.offsetHeight-j-17}h-=i.height;if(k.height>0){h-=k.height+20}h=Math.max(h,this.minHeight);this.canvas.setCanvasSize({height:h.toPx()});var m=0;if(c.clientWidth>0){m=c.clientWidth}else{m=c.offsetWidth}m=Math.max(m,this.minWidth);var l=this.wrapper;if(!l){return}l.style.width=m.toPx()},showAttachBox:function(){if(this.attachBox.useBox){$tx.addClassName(this.elLineBtn,"tx-attach-close");$tx.show(this.attachBox.elBox);this.isAttachBoxDisplay=b}},hideAttachBox:function(){if(this.attachBox.useBox){$tx.removeClassName(this.elLineBtn,"tx-attach-close");$tx.hide(this.attachBox.elBox);this.isAttachBoxDisplay=a}},showFullScreenAtService:function(){if(typeof showFullScreen=="function"){showFullScreen()}},showNormalScreenAtService:function(){if(typeof showNormalScreen=="function"){showNormalScreen()
}},resizeScreenAtService:function(){if(typeof resizeScreen=="function"){resizeScreen()}}});Editor.getTool().fullscreen.oninitialized()})();